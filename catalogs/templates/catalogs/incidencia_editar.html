{% extends 'core/base.html' %}

{% block content %}
<h4>Editar Incidencia</h4>

{% if messages %}
<div class="alert alert-info">
    {% for message in messages %}
        <p>{{ message }}</p>
    {% endfor %}
</div>
{% endif %}

<form method="post">
    {% csrf_token %}
    <div class="form-group mb-3">
        <label for="nombre">Nombre:</label>
        <input type="text" id="nombre" name="nombre" class="form-control" value="{{ incidencia.nombre }}" required>
    </div>

    <div class="form-group mb-3">
        <label for="descripcion">Descripción:</label>
        <textarea id="descripcion" name="descripcion" rows="3" class="form-control">{{ incidencia.descripcion }}</textarea>
    </div>

    <div class="form-group mb-3">
        <label for="direccion">Dirección:</label>
        <select id="direccion" name="direccion" class="form-control" required>
            {% for d in direcciones %}
                <option value="{{ d.direccion_id }}" {% if d == incidencia.direccion %}selected{% endif %}>{{ d.nombre }}</option>
            {% endfor %}
        </select>
    </div>

    <div class="form-group mb-3">
        <label for="departamento">Departamento:</label>
        <select id="departamento" name="departamento" class="form-control" required>
            {% for dep in departamentos %}
                <option value="{{ dep.departamento_id }}" {% if dep == incidencia.departamento %}selected{% endif %}>{{ dep.nombre }}</option>
            {% endfor %}
        </select>
    </div>

    <div class="form-group mb-3">
    <label for="encuesta">Encuesta (opcional):</label>
    <select id="encuesta" name="encuesta" class="form-control">
        <option value="">-- Sin encuesta --</option>
        {% for e in encuestas %}
            <option value="{{ e.id }}" {% if e == incidencia.encuesta %}selected{% endif %}>
                {{ e.titulo }}
            </option>
        {% endfor %}
    </select>
</div>

<button type="submit" class="btn btn-primary">Guardar Cambios</button>
<a href="{% url 'incidencia_listar' %}" class="btn btn-secondary">Volver</a>
</form>
{% endblock %}

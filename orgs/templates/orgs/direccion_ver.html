{% extends 'core/base.html' %}

{% block content %}
<h4>Detalle de Dirección</h4>

{% if messages %}
  <div class="alert alert-info">
    {% for message in messages %}
      <p>{{ message }}</p>
    {% endfor %}
  </div>
{% endif %}

<table class="table table-bordered">
    <tr><th>ID</th><td>{{ direccion.direccion_id }}</td></tr>
    <tr><th>Nombre</th><td>{{ direccion.nombre }}</td></tr>
    <tr>
        <th>Estado</th>
        <td>
            {% if direccion.estado %}
                <span class="badge bg-success">Activa</span>
            {% else %}
                <span class="badge bg-secondary">Bloqueada</span>
            {% endif %}
        </td>
    </tr>
</table>

<h5>Equipo</h5>
{% with memberships=direccion.memberships.all %}
    {% if memberships %}
        <ul class="list-group mb-3">
            {% for membership in memberships %}
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    <span>{{ membership.usuario_id.user.get_full_name|default:membership.usuario_id.user.username }}</span>
                    {% if membership.es_encargado %}
                        <span class="badge bg-primary">Encargado</span>
                    {% endif %}
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p class="text-muted">Sin miembros registrados.</p>
    {% endif %}
{% endwith %}

<a href="{% url 'direccion_editar' direccion.direccion_id %}" class="btn btn-warning">Editar</a>

<form method="post" action="{% url 'direccion_bloquea' direccion.direccion_id %}" style="display:inline;">
    {% csrf_token %}
    <button type="submit" class="btn btn-outline-primary">
        {% if direccion.estado == 'Activo' %}Bloquear{% else %}Activar{% endif %}
    </button>
</form>

<form method="post" action="{% url 'direccion_elimina' direccion.direccion_id %}" style="display:inline;" onsubmit="return confirm('¿Deseas eliminar esta dirección?');">
    {% csrf_token %}
    <button type="submit" class="btn btn-outline-danger">Eliminar</button>
</form>

<a href="{% url 'direccion_listar' %}" class="btn btn-secondary">Volver</a>
{% endblock %}
